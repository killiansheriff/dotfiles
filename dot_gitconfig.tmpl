# ╔══════════════════════════════════════════════════════════════════════════╗
# ║                              GIT CONFIG                                   ║
# ║                         Managed by chezmoi                                ║
# ╚══════════════════════════════════════════════════════════════════════════╝

[user]
    name = {{ .name }}
    email = {{ .email }}

[init]
    defaultBranch = main

[core]
    editor = nvim
    excludesfile = ~/.gitignore_global
    autocrlf = input
    pager = less

[merge]
    conflictstyle = diff3

[diff]
    colorMoved = default

[color]
    ui = auto

[color "branch"]
    current = cyan bold
    local = cyan
    remote = magenta

[color "status"]
    added = green
    changed = yellow
    untracked = red

[color "diff"]
    meta = yellow bold
    frag = magenta bold
    old = red
    new = green

[pull]
    rebase = true

[push]
    default = current
    autoSetupRemote = true
    followTags = true

[fetch]
    prune = true
    pruneTags = true

[rebase]
    autoStash = true
    autoSquash = true

[rerere]
    enabled = true

[branch]
    sort = -committerdate

[alias]
    # ─────────────────────────────────────────────────────────────────────────
    # Status & Info
    # ─────────────────────────────────────────────────────────────────────────
    s = status -sb
    st = status
    
    # ─────────────────────────────────────────────────────────────────────────
    # Commits
    # ─────────────────────────────────────────────────────────────────────────
    c = commit
    cm = commit -m
    ca = commit --amend
    can = commit --amend --no-edit
    
    # ─────────────────────────────────────────────────────────────────────────
    # Branches
    # ─────────────────────────────────────────────────────────────────────────
    co = checkout
    cob = checkout -b
    br = branch
    bra = branch -a
    brd = branch -d
    brD = branch -D
    
    # ─────────────────────────────────────────────────────────────────────────
    # Diffs
    # ─────────────────────────────────────────────────────────────────────────
    d = diff
    ds = diff --staged
    dc = diff --cached
    
    # ─────────────────────────────────────────────────────────────────────────
    # Logs (pretty)
    # ─────────────────────────────────────────────────────────────────────────
    l = log --oneline -20
    lg = log --graph --oneline --decorate --all
    ll = log --graph --pretty=format:'%C(yellow)%h%Creset -%C(auto)%d%Creset %s %C(dim)(%cr) %C(cyan)<%an>%Creset' --abbrev-commit
    last = log -1 HEAD --stat
    
    # ─────────────────────────────────────────────────────────────────────────
    # Stash
    # ─────────────────────────────────────────────────────────────────────────
    ss = stash save
    sp = stash pop
    sl = stash list
    sd = stash drop
    
    # ─────────────────────────────────────────────────────────────────────────
    # Reset & Undo
    # ─────────────────────────────────────────────────────────────────────────
    unstage = reset HEAD --
    undo = reset --soft HEAD~1
    nuke = reset --hard HEAD
    
    # ─────────────────────────────────────────────────────────────────────────
    # Remote
    # ─────────────────────────────────────────────────────────────────────────
    p = push
    pf = push --force-with-lease
    pl = pull
    f = fetch --all --prune
    
    # ─────────────────────────────────────────────────────────────────────────
    # Utilities
    # ─────────────────────────────────────────────────────────────────────────
    # List aliases
    aliases = config --get-regexp alias
    # Show contributors
    contributors = shortlog --summary --numbered
    # Find branches containing commit
    fb = "!f() { git branch -a --contains $1; }; f"
    # Interactive rebase with last n commits
    ri = "!f() { git rebase -i HEAD~$1; }; f"
    # Clean up merged branches
    cleanup = "!git branch --merged | grep -v '\\*\\|main\\|master' | xargs -n 1 git branch -d"
    # WIP commit
    wip = !git add -A && git commit -m "WIP"
    # Undo WIP
    unwip = reset HEAD~1

[url "git@github.com:"]
    insteadOf = gh:

[url "git@github.com:{{ .github_username }}/"]
    insteadOf = my:

[url "git@gitlab.com:"]
    insteadOf = gl:

[github]
    user = {{ .github_username }}

# ─────────────────────────────────────────────────────────────────────────────
# Credential helpers (OS-specific)
# ─────────────────────────────────────────────────────────────────────────────
{{ if eq .chezmoi.os "darwin" -}}
[credential]
    helper = osxkeychain
{{ else if eq .chezmoi.os "linux" -}}
[credential]
    helper = cache --timeout=3600
{{ end -}}
